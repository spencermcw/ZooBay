import{x as R,d as z,u as D,k as Z,c as _,r as N,y as F,o as n,a as o,b as s,t as d,n as t,z as y,e as x,B as j,l as V,_ as q,i as U,C as P,D as W,p as r,q as L,E as $,h as J,M as tt,f as K,F as st,j as et,H as nt,m as l,I as Q,J as S,G as T,K as E,L as ot,N as it,O as I,s as G,P as Y,Q as lt,A as at,R as dt}from"./index.73e4f978.js";const H=c=>(P("data-v-282da9fa"),c=c(),W(),c),ct={class:"allowance"},rt=["onSubmit"],_t=H(()=>s("p",{class:"h1"},"$ZOO Allowance",-1)),ut=H(()=>s("p",null,[s("i",{class:"bi bi-exclamation-triangle gold me-1"}),r(" We strongly suggest making this large enough to place multiple bids so you don't have to do this every time! ")],-1)),ht=r("Current Allowance: "),pt={class:"gold wb"},gt=r(" $ZOO "),bt=["disabled"],vt=r(" INCREASE ALLOWANCE "),mt=H(()=>s("a",{href:"https://ethereum.org/en/developers/tutorials/understand-the-erc-20-token-smart-contract/",target:"_blank",class:"text-muted"},"more info",-1)),yt=z({setup(c){const i=D(Z),h=_(()=>i.state.allowance),b=_(()=>i.state.txnPending),g=N("0"),p=()=>{F(g.value)!=="Invalid"&&i.dispatch(L.INCREASE_ALLOWANCE,$(g.value))},e=_(()=>F(g.value)==="Invalid");return(B,f)=>(n(),o("div",ct,[s("form",{class:"d-grid gap-2",onSubmit:U(p,["prevent"])},[_t,ut,s("p",null,[ht,s("span",pt,d(t(y)(t(h))),1),gt]),x(j,{label:"Increase Allowance By",onChange:f[0]||(f[0]=A=>g.value=A)}),s("button",{class:"btn cz-btn cz-btn--primary",type:"submit",disabled:t(b)||t(e)},[x(V,{spinning:t(b)},null,8,["spinning"]),vt],8,bt),x(q,{disabled:!0}),mt],40,rt)]))}});var ft=R(yt,[["__scopeId","data-v-282da9fa"]]);const wt={class:"approvals-modal"},kt={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable"},$t={class:"modal-content"},xt={class:"modal-body"},At=z({setup(c,{expose:i}){const h=N(null),b=N(null);J(()=>{b.value=new tt(h.value)});const g=()=>{b.value.show()},p=()=>{b.value.hide()};return i({show:g,hide:p}),(e,B)=>(n(),o("div",wt,[s("div",{class:"modal fade",ref_key:"modalRef",ref:h},[s("div",kt,[s("div",$t,[s("div",xt,[x(ft),s("button",{class:"btn cz-btn",onClick:p},"Close")])])])],512)]))}});var Ot=R(At,[["__scopeId","data-v-53cd55a0"]]);const Nt=c=>(P("data-v-eb7d5dc4"),c=c(),W(),c),Bt={class:"container-fluid bids"},Ct=["onSubmit"],Et={key:0},It=r(" Minimum Bid: "),St={class:"gold wb"},Lt=r(" $ZOO "),Rt={key:1},zt=r(" Buy Now: "),Mt={class:"gold wb"},Tt=r(" $ZOO "),Dt={key:1},Zt={key:2},Vt={key:3},Pt=["disabled"],Wt={key:0},Ht={key:1},Ft={key:0},Gt={key:1},Yt=Nt(()=>s("i",{class:"bi bi-info-circle cz-link"},null,-1)),jt=z({props:{listing:null},setup(c){const i=c,h=D(Z),b=K(),g=N(null),p=N("0"),e=_(()=>h.state.allowance);_(()=>h.getters[T.ACTIVE_ACCOUNT_ADDRESS]);const B=_(()=>h.state.zooBalance),f=_(()=>h.state.txnPending),A=_(()=>{if(i.listing.bids.length>0){const w=E.from(i.listing.bids[0].amount),k=w.mul(11).div(10),O=w.add($("1"));return E.from(i.listing.price).gt(0)&&k.gt(i.listing.price)?i.listing.price:O.gt(k)?O.toString():k.toString()}else return i.listing.minBid}),M=_(()=>a.value||m.value),C=_(()=>{try{return E.from(i.listing.price).gt(0)&&$(p.value).gte(i.listing.price)}catch{return!1}}),a=_(()=>{try{return $(p.value).lt(A.value)}catch{return!0}}),m=_(()=>{try{return $(p.value).gt($(B.value))}catch{return!1}}),v=_(()=>{try{return E.from(e.value).lt($(p.value))}catch{return!0}}),X=()=>{if(v.value)return g.value.show();h.dispatch(L.CREATE_BID,{listingId:i.listing.id,amount:$(p.value)}).then(()=>{C.value?b.push({name:"ManageComplete"}):b.go(0)}).catch(console.error)};return J(()=>{i.listing.buyNowOnly&&(p.value=st(i.listing.price))}),(w,k)=>(n(),o("div",Bt,[x(Ot,{ref_key:"allowanceModalRef",ref:g},null,512),et(s("form",{class:"d-grid gap-3",onSubmit:U(X,["prevent"])},[s("div",null,[c.listing.buyNowOnly?l("",!0):(n(),o("p",Et,[It,s("span",St,d(t(y)(t(A))),1),Lt])),t(Q).BigNumber.from(c.listing.price).gt(0)?(n(),o("p",Rt,[zt,s("span",Mt,d(t(y)(c.listing.price)),1),Tt])):l("",!0)]),s("div",null,[c.listing.buyNowOnly?l("",!0):(n(),S(j,{key:0,label:"Bid Amount",onChange:k[0]||(k[0]=O=>p.value=O)})),t(a)?(n(),o("p",Dt," Bid too low ")):l("",!0),t(m)?(n(),o("p",Zt," You don't have enough $ZOO ")):l("",!0),t(v)?(n(),o("p",Vt," Your $ZOO Allowance is too low ")):l("",!0)]),s("button",{class:"btn cz-btn cz-btn--primary",type:"submit",disabled:t(f)||t(M)},[x(V,{spinning:t(f)},null,8,["spinning"]),t(v)?(n(),o("span",Wt,"INCREASE ALLOWANCE")):(n(),o("div",Ht,[t(C)?(n(),o("span",Ft,"BUY NOW")):(n(),o("span",Gt,"PLACE BID"))]))],8,Pt),s("p",{class:"text-muted",onClick:k[1]||(k[1]=(...O)=>g.value.show&&g.value.show(...O))},[Yt,r(" Allowance: "+d(t(y)(t(e))),1)])],40,Ct),[[nt,c.listing]])]))}});var qt=R(jt,[["__scopeId","data-v-eb7d5dc4"]]);const u=c=>(P("data-v-0c343a1c"),c=c(),W(),c),Ut={key:0,class:"container"},Jt=u(()=>s("h1",null,"Loading Listing...",-1)),Kt={key:1,class:"container"},Qt=u(()=>s("h1",null,"No Listing Found...",-1)),Xt=[Qt],ts={key:2,class:"container listing-container"},ss={class:"row"},es={class:"col-12 col-lg-5"},ns={class:"d-flex gap-3 justify-content-between"},os=["disabled"],is=u(()=>s("i",{class:"bi bi-chevron-left"},null,-1)),ls=[is],as=["disabled"],ds=u(()=>s("i",{class:"bi bi-chevron-right"},null,-1)),cs=[ds],rs={key:0},_s=u(()=>s("i",{class:"bi bi-clock me-3"},null,-1)),us={key:1,class:"bi bi-infinity"},hs={key:1},ps={key:0},gs={key:1},bs=r(" Sold for"),vs=u(()=>s("br",null,null,-1)),ms={class:"gold wb"},ys=r(" $ZOO "),fs={class:"listing-details my-3"},ws={key:0},ks={class:"listing-details__type"},$s={class:"listing-details__title"},xs={key:1},As=u(()=>s("p",{class:"listing-details__type"},"Bundle",-1)),Os={class:"listing-details__title"},Ns={key:2},Bs=u(()=>s("strong",null,"Current Bid: ",-1)),Cs={class:"gold wb"},Es=r(" $ZOO "),Is={key:3},Ss=u(()=>s("strong",null,"Starting Bid: ",-1)),Ls={class:"gold wb"},Rs=r(" $ZOO "),zs={key:4},Ms=u(()=>s("strong",null,"Buy Now: ",-1)),Ts={class:"gold wb"},Ds=r(" $ZOO "),Zs=u(()=>s("strong",null,"Seller: ",-1)),Vs={key:0,class:"gold"},Ps={key:1},Ws={key:5},Hs=u(()=>s("strong",null,"# Bids:",-1)),Fs={key:6},Gs=u(()=>s("strong",null,"# Bidders:",-1)),Ys=u(()=>s("strong",null,"Listed:",-1)),js={key:7},qs=u(()=>s("strong",null,"Ends:",-1)),Us=r("\xA0 "),Js={key:0},Ks={key:1},Qs=u(()=>s("i",{class:"bi bi-infinity"},null,-1)),Xs=[Qs],te={key:2,class:"d-flex flex-column text-center gap-2 my-3"},se=r(" Connect Wallet to start Bidding! "),ee={class:"my-5"},ne=u(()=>s("p",{class:"h3"},"History",-1)),oe={key:0},ie={key:1,class:"bids-table"},le=u(()=>s("thead",null,[s("th",null,"Bid"),s("th",null,"Bidder"),s("th",null,"Time")],-1)),ae=["href"],de={class:"col-12 col-lg-7"},ce=z({setup(c){const i=D(Z),h=K(),b=N(!0),g=_(()=>i.getters[T.ACTIVE_ACCOUNT_ADDRESS]),p=_(()=>i.getters[T.LOGGED_IN]),e=_(()=>{const a=h.currentRoute.value.params.id;return i.state.listings.find(m=>m.id===a)}),B=_(()=>{const a=new Set;return e.value.bids.forEach(m=>a.add(m.bidder)),a.size}),f=_(()=>{if(!e.value)return;const a=i.state.listings.findIndex(v=>v.id===e.value.id);return i.state.listings[a+1]}),A=_(()=>{if(!e.value)return;const a=i.state.listings.findIndex(v=>v.id===e.value.id);return i.state.listings[a-1]}),M=()=>{const a=f.value;a!==void 0&&h.replace({name:"Listing",params:{id:a.id}})},C=()=>{const a=A.value;a!==void 0&&h.replace({name:"Listing",params:{id:a.id}})};return ot(async()=>{const a=[];p.value&&a.push(i.dispatch(L.FETCH_ALLOWANCE)),e.value||a.push(i.dispatch(L.FETCH_LISTINGS,{id:h.currentRoute.value.params.id})),Promise.all(a).then(()=>{b.value=!1}).catch(console.error)}),(a,m)=>(n(),o(Y,null,[b.value?(n(),o("div",Ut,[Jt,x(V)])):l("",!0),!b.value&&!t(e)?(n(),o("div",Kt,Xt)):l("",!0),!b.value&&t(e)?(n(),o("div",ts,[s("div",ss,[s("div",es,[s("h1",ns,[s("button",{class:"btn cz-btn cz-btn--secondary px-3",onClick:C,disabled:t(A)===void 0},ls,8,os),r(" Listing "+d(t(h).currentRoute.value.params.id)+" ",1),s("button",{class:"btn cz-btn cz-btn--secondary px-3",onClick:M,disabled:t(f)===void 0},cs,8,as)]),t(e).expired?l("",!0):(n(),o("h2",rs,[_s,t(e).buyNowOnly?l("",!0):(n(),S(it,{key:0,expiration:t(e).expiresAt},null,8,["expiration"])),t(e).buyNowOnly?(n(),o("i",us)):l("",!0)])),t(e).expired?(n(),o("h2",hs,[t(e).bids.length<1?(n(),o("span",ps,"Closed")):l("",!0),t(e).bids.length>0?(n(),o("div",gs,[bs,vs,s("span",ms,d(t(y)(t(e).bids[0].amount)),1),ys])):l("",!0)])):l("",!0),s("p",null,"on "+d(t(I).unix(Number(t(e).expiresAt))),1),s("div",fs,[t(e).assets.length<2?(n(),o("div",ws,[s("p",ks,d(t(e).assets[0].metadata.type),1),s("p",$s,d(t(e).assets[0].metadata.type)+" "+d(t(e).assets[0].id),1)])):(n(),o("div",xs,[As,s("p",Os,d(t(e).assets.length)+" CryptoZoo Assets",1)])),t(e).bids.length>0?(n(),o("p",Ns,[Bs,s("span",Cs,d(t(y)(t(e).bids[0].amount)),1),Es])):(n(),o("p",Is,[Ss,s("span",Ls,d(t(y)(t(e).minBid)),1),Rs])),t(Q).BigNumber.from(t(e).price).gt(0)?(n(),o("p",zs,[Ms,s("span",Ts,d(t(y)(t(e).price)),1),Ds])):l("",!0),s("p",null,[Zs,t(e).creator===t(g)?(n(),o("span",Vs," You ")):(n(),o("span",Ps,d(t(G)(t(e).creator)),1))]),t(e).buyNowOnly?l("",!0):(n(),o("p",Ws,[Hs,r(" "+d(t(e).bids.length),1)])),t(e).buyNowOnly?l("",!0):(n(),o("p",Fs,[Gs,r(" "+d(t(B)),1)])),s("p",null,[Ys,r(" "+d(t(I).unix(Number(t(e).createdAt))),1)]),t(e).expired?l("",!0):(n(),o("p",js,[qs,Us,t(e).buyNowOnly?l("",!0):(n(),o("span",Js,d(t(I).unix(Number(t(e).expiresAt))),1)),t(e).buyNowOnly?(n(),o("span",Ks,Xs)):l("",!0)]))]),t(p)?l("",!0):(n(),o("div",te,[se,x(q)])),t(p)&&!t(e).expired?(n(),S(qt,{listing:t(e),key:t(e).id},null,8,["listing"])):l("",!0),s("div",ee,[ne,t(e).bids.length<1?(n(),o("p",oe,"No bids yet - be the first!")):l("",!0),t(e).bids.length>0?(n(),o("table",ie,[le,s("tbody",null,[(n(!0),o(Y,null,lt(t(e).bids,v=>(n(),o("tr",{class:dt({white:v.bidder===t(g)})},[s("td",null,d(t(y)(v.amount))+" $ZOO",1),s("td",null,[s("a",{href:"https://bscscan.com/token/0x7ffc1243232da3ac001994208e2002816b57c669?a="+v.bidder,target:"_blank"},d(v.bidder===t(g)?"You":t(G)(v.bidder)),9,ae)]),s("td",null,d(t(I).unix(Number(v.timestamp)).format("D MMM @ HH:mm:ss ")),1)],2))),256))])])):l("",!0)])]),s("div",de,[(n(),S(at,{assets:t(e).assets,cols:1,key:t(e).id},null,8,["assets"]))])])])):l("",!0)],64))}});var _e=R(ce,[["__scopeId","data-v-0c343a1c"]]);export{_e as default};
